const _0x4f4dbe=_0x5504;(function(_0x1d68b3,_0x3a584c){const _0x26ba06=_0x5504,_0x12f989=_0x1d68b3();while(!![]){try{const _0xfd91c7=-parseInt(_0x26ba06(0x165))/0x1+-parseInt(_0x26ba06(0x1d0))/0x2*(parseInt(_0x26ba06(0x16e))/0x3)+parseInt(_0x26ba06(0x196))/0x4*(-parseInt(_0x26ba06(0x1a1))/0x5)+parseInt(_0x26ba06(0x17d))/0x6+-parseInt(_0x26ba06(0x18e))/0x7+parseInt(_0x26ba06(0x178))/0x8*(-parseInt(_0x26ba06(0x167))/0x9)+parseInt(_0x26ba06(0x1c5))/0xa*(parseInt(_0x26ba06(0x1af))/0xb);if(_0xfd91c7===_0x3a584c)break;else _0x12f989['push'](_0x12f989['shift']());}catch(_0x1d7ad9){_0x12f989['push'](_0x12f989['shift']());}}}(_0x42c7,0xf0dbc));let sessionExpiryTime=null,currentSessionInfo={'sessionId':null,'originalCode':null,'isValid':!![],'createdAt':null,'deviceFingerprint':null,'sessionToken':null,'browserId':null},heartbeatInterval=null,monitoringInterval=null,verifyFingerprint=![];const browserInstanceId=_0x4f4dbe(0x1d1);let originalCookies=null,cookieMonitoringInterval=null,isSessionClosing=![],sessionPersistenceEnabled=!![],protectedCookies=null,isRestoringCookies=![];const PROTECTED_COOKIES_KEY=_0x4f4dbe(0x16a),SESSION_INFO_KEY=_0x4f4dbe(0x195),PROTECTION_ENABLED_KEY=_0x4f4dbe(0x18f),IDB_NAME=_0x4f4dbe(0x15c),IDB_VERSION=0x1,IDB_STORE_COOKIES=_0x4f4dbe(0x161),IDB_STORE_SESSION='session_info';let db=null;const ACCESS_FREEDOM_VERSION=_0x4f4dbe(0x170);async function initIndexedDB(){return new Promise((_0x1a33bc,_0x41a02f)=>{const _0x23ba99=_0x5504,_0x55729c=indexedDB[_0x23ba99(0x182)](IDB_NAME,IDB_VERSION);_0x55729c['onerror']=()=>{_0x41a02f(_0x55729c['error']);},_0x55729c[_0x23ba99(0x1b3)]=()=>{db=_0x55729c['result'],_0x1a33bc(db);},_0x55729c[_0x23ba99(0x1a0)]=_0x523756=>{const _0x985e5e=_0x23ba99,_0x428e75=_0x523756[_0x985e5e(0x1b6)]['result'];if(!_0x428e75[_0x985e5e(0x18b)][_0x985e5e(0x181)](IDB_STORE_COOKIES)){const _0x3aff26=_0x428e75[_0x985e5e(0x1bc)](IDB_STORE_COOKIES,{'keyPath':_0x985e5e(0x173)});_0x3aff26[_0x985e5e(0x156)](_0x985e5e(0x1d5),_0x985e5e(0x1d5),{'unique':![]});}if(!_0x428e75[_0x985e5e(0x18b)][_0x985e5e(0x181)](IDB_STORE_SESSION)){const _0x4b5b8b=_0x428e75[_0x985e5e(0x1bc)](IDB_STORE_SESSION,{'keyPath':_0x985e5e(0x1b2)});_0x4b5b8b[_0x985e5e(0x156)](_0x985e5e(0x1d5),_0x985e5e(0x1d5),{'unique':![]});}};});}async function saveCookiesToIndexedDB(_0x40eab1){if(!db)await initIndexedDB();return new Promise((_0x310a05,_0x4d6d24)=>{const _0x4d3aea=_0x5504,_0x34e69d=db[_0x4d3aea(0x16b)]([IDB_STORE_COOKIES],_0x4d3aea(0x1cb)),_0x561e70=_0x34e69d[_0x4d3aea(0x1bb)](IDB_STORE_COOKIES),_0x5a2f9d=_0x561e70[_0x4d3aea(0x157)]();_0x5a2f9d['onsuccess']=()=>{const _0x5eab7d=_0x4d3aea;_0x40eab1['forEach'](_0x5774b1=>{const _0x7642c4=_0x5504;_0x5774b1[_0x7642c4(0x1d5)]=Date['now'](),_0x561e70['put'](_0x5774b1);}),_0x34e69d[_0x5eab7d(0x172)]=()=>{_0x310a05(!![]);},_0x34e69d[_0x5eab7d(0x158)]=()=>{const _0x320639=_0x5eab7d;_0x4d6d24(_0x34e69d[_0x320639(0x175)]);};};});}async function loadCookiesFromIndexedDB(){if(!db)await initIndexedDB();return new Promise((_0x538e4b,_0xc9faec)=>{const _0x245881=_0x5504,_0x408393=db[_0x245881(0x16b)]([IDB_STORE_COOKIES],'readonly'),_0x9c351d=_0x408393[_0x245881(0x1bb)](IDB_STORE_COOKIES),_0x24f0d2=_0x9c351d[_0x245881(0x180)]();_0x24f0d2[_0x245881(0x1b3)]=()=>{const _0x3777ba=_0x245881,_0x1d2d46=_0x24f0d2[_0x3777ba(0x150)];_0x538e4b(_0x1d2d46);},_0x24f0d2[_0x245881(0x158)]=()=>{const _0x54dccf=_0x245881;_0xc9faec(_0x408393[_0x54dccf(0x175)]);};});}async function saveSessionToIndexedDB(_0x480407){if(!db)await initIndexedDB();return new Promise((_0x266a26,_0x3d5c37)=>{const _0x78b8=_0x5504,_0x118a62=db[_0x78b8(0x16b)]([IDB_STORE_SESSION],_0x78b8(0x1cb)),_0x1538c7=_0x118a62[_0x78b8(0x1bb)](IDB_STORE_SESSION);_0x480407['timestamp']=Date[_0x78b8(0x171)]();const _0x3334b5=_0x1538c7['put'](_0x480407);_0x3334b5['onsuccess']=()=>{_0x266a26(!![]);},_0x3334b5[_0x78b8(0x158)]=()=>{_0x3d5c37(_0x118a62['error']);};});}async function loadSessionFromIndexedDB(){if(!db)await initIndexedDB();return new Promise((_0x108648,_0x3e4198)=>{const _0x451146=_0x5504,_0x62b915=db[_0x451146(0x16b)]([IDB_STORE_SESSION],'readonly'),_0x4355ce=_0x62b915['objectStore'](IDB_STORE_SESSION),_0x16b752=_0x4355ce[_0x451146(0x180)]();_0x16b752[_0x451146(0x1b3)]=()=>{const _0x5284d0=_0x451146,_0x43ce4f=_0x16b752[_0x5284d0(0x150)];if(_0x43ce4f&&_0x43ce4f[_0x5284d0(0x17e)]>0x0){const _0x34c57f=_0x43ce4f[_0x5284d0(0x17b)]((_0x308fd1,_0x375e41)=>_0x375e41['timestamp']>_0x308fd1[_0x5284d0(0x1d5)]?_0x375e41:_0x308fd1);_0x108648(_0x34c57f);}else _0x108648(null);},_0x16b752[_0x451146(0x158)]=()=>{const _0xc4bb90=_0x451146;_0x3e4198(_0x62b915[_0xc4bb90(0x175)]);};});}function generateBrowserInstanceId(){const _0x4187cf=_0x4f4dbe;return _0x4187cf(0x1d1);}function saveSessionExpiry(_0x2f3b1b){const _0x466560=_0x4f4dbe;sessionExpiryTime=_0x2f3b1b,chrome['storage'][_0x466560(0x1c1)][_0x466560(0x1d6)]({'sessionExpiryTime':_0x2f3b1b});}function loadSessionExpiry(){return new Promise(_0x4cf865=>{const _0xfb77c1=_0x5504;chrome[_0xfb77c1(0x176)]['local'][_0xfb77c1(0x1a9)]([_0xfb77c1(0x19d)],_0x185d9b=>{const _0x1492bc=_0xfb77c1;sessionExpiryTime=_0x185d9b[_0x1492bc(0x19d)]||null,_0x4cf865(sessionExpiryTime);});});}async function saveProtectedCookiesToStorage(_0x3d5c8b){const _0x57e7e5=_0x4f4dbe;try{const _0x21e4c5=_0x3d5c8b[_0x57e7e5(0x1a4)](_0x102354=>({'name':_0x102354[_0x57e7e5(0x173)],'value':_0x102354['value'],'domain':_0x102354[_0x57e7e5(0x193)]||'.crunchyroll.com','path':_0x102354[_0x57e7e5(0x194)]||'/','secure':_0x102354['secure']!==![],'httpOnly':_0x102354[_0x57e7e5(0x1b9)]!==![],'expirationDate':_0x102354[_0x57e7e5(0x18a)]||Date[_0x57e7e5(0x171)]()/0x3e8+0x3f480}));await chrome[_0x57e7e5(0x176)][_0x57e7e5(0x1c1)]['set']({[PROTECTED_COOKIES_KEY]:_0x21e4c5,[PROTECTION_ENABLED_KEY]:!![]}),await saveCookiesToIndexedDB(_0x21e4c5);}catch(_0x4ec976){}}async function loadProtectedCookiesFromStorage(){const _0x31380f=_0x4f4dbe;try{const _0x3e0abd=await chrome['storage'][_0x31380f(0x1c1)]['get']([PROTECTED_COOKIES_KEY,PROTECTION_ENABLED_KEY]);if(_0x3e0abd[PROTECTION_ENABLED_KEY]&&_0x3e0abd[PROTECTED_COOKIES_KEY])return protectedCookies=_0x3e0abd[PROTECTED_COOKIES_KEY],!![];const _0x44ee8a=await loadCookiesFromIndexedDB();if(_0x44ee8a&&_0x44ee8a[_0x31380f(0x17e)]>0x0)return protectedCookies=_0x44ee8a,await chrome[_0x31380f(0x176)][_0x31380f(0x1c1)][_0x31380f(0x1d6)]({[PROTECTED_COOKIES_KEY]:_0x44ee8a,[PROTECTION_ENABLED_KEY]:!![]}),!![];return![];}catch(_0x1c956a){return![];}}async function saveSessionInfoToStorage(){const _0xb9fb18=_0x4f4dbe;try{await chrome[_0xb9fb18(0x176)][_0xb9fb18(0x1c1)][_0xb9fb18(0x1d6)]({[SESSION_INFO_KEY]:currentSessionInfo}),await saveSessionToIndexedDB(currentSessionInfo);}catch(_0x122b55){}}async function loadSessionInfoFromStorage(){const _0x25cb8e=_0x4f4dbe;try{const _0x913818=await chrome['storage'][_0x25cb8e(0x1c1)][_0x25cb8e(0x1a9)]([SESSION_INFO_KEY]);if(_0x913818[SESSION_INFO_KEY])return currentSessionInfo=_0x913818[SESSION_INFO_KEY],!![];const _0x2b1a94=await loadSessionFromIndexedDB();if(_0x2b1a94)return currentSessionInfo=_0x2b1a94,await chrome[_0x25cb8e(0x176)]['local']['set']({[SESSION_INFO_KEY]:_0x2b1a94}),!![];return![];}catch(_0x2e03d1){return![];}}loadSessionExpiry();async function initializePersistentData(){const _0x478bb9=_0x4f4dbe;try{await initIndexedDB();const _0x41a34f=await loadProtectedCookiesFromStorage(),_0x3f4554=await loadSessionInfoFromStorage();currentSessionInfo[_0x478bb9(0x1b2)]&&(startCookieMonitoring(),startSecurityMonitoring(),currentSessionInfo['sessionId']&&startHeartbeat(currentSessionInfo[_0x478bb9(0x1b2)]));}catch(_0x1d53a7){}}initializePersistentData();async function generateDeviceFingerprint(){const _0x5e499c=_0x4f4dbe;try{const _0x4b8207=[_0x5e499c(0x189),navigator['userAgent'],Intl['DateTimeFormat']()[_0x5e499c(0x1c6)]()['timeZone'],navigator[_0x5e499c(0x1ca)]],_0x349957=_0x4b8207[_0x5e499c(0x19c)]('|'),_0x179ba0=new TextEncoder(),_0x45f19e=_0x179ba0[_0x5e499c(0x159)](_0x349957),_0x47a0ec=await crypto['subtle'][_0x5e499c(0x1c8)]('SHA-256',_0x45f19e),_0x4a4766=Array[_0x5e499c(0x166)](new Uint8Array(_0x47a0ec));return _0x4a4766['map'](_0x5d4351=>_0x5d4351[_0x5e499c(0x198)](0x10)[_0x5e499c(0x1b1)](0x2,'0'))['join']('');}catch(_0x2a4d2b){return _0x5e499c(0x184);}}function isSessionPasteCode(_0x173d9f){return _0x173d9f['startsWith']('session_paste');}async function getCrunchyrollCookies(){const _0xbd85cf=_0x4f4dbe;try{return await chrome['cookies'][_0xbd85cf(0x180)]({'domain':_0xbd85cf(0x177)});}catch(_0x420f5f){return[];}}function compareCookies(_0x5cb5e7,_0xc48e4a){return![];}async function restoreProtectedCookies(){const _0xa484f7=_0x4f4dbe;if(!protectedCookies||isRestoringCookies)return;isRestoringCookies=!![];try{const _0x40931f=[_0xa484f7(0x1cf),_0xa484f7(0x1ce),_0xa484f7(0x1ad)],_0x1d0df9=await getCrunchyrollCookies();let _0x1a6681=![];for(const _0x2fbed4 of _0x40931f){const _0x524877=protectedCookies[_0xa484f7(0x1c3)](_0x1fcf0a=>_0x1fcf0a[_0xa484f7(0x173)]===_0x2fbed4),_0x33ab67=_0x1d0df9[_0xa484f7(0x1c3)](_0x360d5f=>_0x360d5f[_0xa484f7(0x173)]===_0x2fbed4);if(!_0x33ab67||_0x524877&&_0x524877[_0xa484f7(0x192)]!==_0x33ab67[_0xa484f7(0x192)]){_0x1a6681=!![];break;}}if(_0x1a6681)for(const _0x2f6940 of _0x40931f){const _0xc8a4d4=protectedCookies['find'](_0x5bb72b=>_0x5bb72b[_0xa484f7(0x173)]===_0x2f6940);if(_0xc8a4d4)try{await chrome[_0xa484f7(0x199)][_0xa484f7(0x1d6)]({'url':_0xa484f7(0x151),'name':_0xc8a4d4['name'],'value':_0xc8a4d4['value'],'domain':_0xc8a4d4['domain']||_0xa484f7(0x177),'path':_0xc8a4d4[_0xa484f7(0x194)]||'/','secure':_0xc8a4d4[_0xa484f7(0x15b)]!==![],'httpOnly':_0xc8a4d4[_0xa484f7(0x1b9)]!==![],'expirationDate':_0xc8a4d4[_0xa484f7(0x18a)]||Date[_0xa484f7(0x171)]()/0x3e8+0x3f480});}catch(_0x23d01f){}}}catch(_0x192b16){}finally{isRestoringCookies=![];}}function startCookieMonitoring(){cookieMonitoringInterval&&clearInterval(cookieMonitoringInterval),cookieMonitoringInterval=setInterval(async()=>{const _0x434d76=_0x5504;try{if(!currentSessionInfo[_0x434d76(0x1b2)]||!currentSessionInfo[_0x434d76(0x191)]||isSessionClosing||isRestoringCookies)return;const _0x31e36f=await getCrunchyrollCookies();if(!originalCookies){originalCookies=_0x31e36f,protectedCookies=[..._0x31e36f],await saveProtectedCookiesToStorage(protectedCookies);return;}const _0xa7c506=['session_id','etp_rt',_0x434d76(0x1ad)],_0x105170=_0xa7c506[_0x434d76(0x1be)](_0x1a5eac=>_0x31e36f[_0x434d76(0x1be)](_0x4a684c=>_0x4a684c[_0x434d76(0x173)]===_0x1a5eac));!_0x105170&&await restoreProtectedCookies();}catch(_0x541093){}},0x493e0);}function stopCookieMonitoring(){cookieMonitoringInterval&&(clearInterval(cookieMonitoringInterval),cookieMonitoringInterval=null),originalCookies=null;}function _0x42c7(){const _0x4d60ac=['5829530LiywTG','crunchyroll_protection_enabled','message','isValid','value','domain','path','crunchyroll_session_info','653948BKAzdw','sessionExpired','toString','cookies','La\x20sesión\x20ha\x20expirado','windows','join','sessionExpiryTime','encryptedData','token','onupgradeneeded','40fsHfdY','Error\x20al\x20configurar\x20el\x20bloqueador\x20de\x20emparejamiento\x20de\x20TV:','/tv','map','session_expired','showTVPairingBlocked','sendMessage','action','get','then','disable','debug','etp_client_token','https://www.crunchyroll.com/','3014HriwGP','forEach','padStart','sessionId','onsuccess','El\x20fingerprint\x20del\x20dispositivo\x20no\x20coincide\x20con\x20el\x20de\x20la\x20sesión\x20original','active','target','remove','Este\x20código\x20no\x20es\x20para\x20Crunchyroll\x20Access\x20Freedom\x20versión\x202.0','httpOnly','/activate','objectStore','createObjectStore','addListener','some','runtime','webNavigation','local','catch','find','invalidateSessionOnPaste','254690IdWIyi','resolvedOptions','toggleSessionPersistence','digest','lastError','language','readwrite','url','update','etp_rt','session_id','2983906VGhBhh','UNLIMITED_USERS_ACCESS','endSession','restorePermanentSession','removed','timestamp','set','create','securityLog','result','https://www.crunchyroll.com','accessKey','sessionPasteDetected','reload','sessionToken','createIndex','clear','onerror','encode','Error\x20al\x20restaurar\x20la\x20sesión:\x20','secure','CrunchyrollProtectionDB','No\x20se\x20permiten\x20códigos\x20de\x20session_paste.\x20La\x20sesión\x20actual\x20ha\x20sido\x20invalidada.','/pair','toggleFingerprintVerification','getSessionExpiry','protected_cookies','log','El\x20token\x20de\x20sesión\x20no\x20es\x20válido\x20o\x20ha\x20expirado','enabled','1538633bhDRzY','from','45cLUkEt','includes','query','crunchyroll_protected_cookies','transaction','onStartup','enable','3lzmoJp','split','2.0','now','oncomplete','name','tabs','error','storage','.crunchyroll.com','2181744TmaQzP','onInstalled','unshift','reduce','parse','3257472XAYXKs','length','Código\x20de\x20sesión\x20inválido:\x20','getAll','contains','open','deviceFingerprint','crunchyroll_unlimited_fingerprint_123456789','expiresAt','onBeforeNavigate','version','cookie','crunchyroll_session_unlimited','expirationDate','objectStoreNames','tabId','webNavigation\x20API\x20no\x20disponible\x20en\x20este\x20navegador'];_0x42c7=function(){return _0x4d60ac;};return _0x42c7();}function startHeartbeat(_0x3836ee){heartbeatInterval&&clearInterval(heartbeatInterval),heartbeatInterval=setInterval(async()=>{const _0x4ee3ad=_0x5504;try{if(!currentSessionInfo[_0x4ee3ad(0x1b2)]||!currentSessionInfo[_0x4ee3ad(0x191)]||isSessionClosing){clearInterval(heartbeatInterval),heartbeatInterval=null;return;}await chrome[_0x4ee3ad(0x176)][_0x4ee3ad(0x1c1)][_0x4ee3ad(0x1d6)]({['heartbeat_'+_0x3836ee]:Date[_0x4ee3ad(0x171)]()});try{await chrome[_0x4ee3ad(0x199)][_0x4ee3ad(0x1d6)]({'url':_0x4ee3ad(0x151),'name':'cr_session_id_heartbeat','value':'UNLIMITED_ACCESS','domain':'.crunchyroll.com','secure':!![],'httpOnly':![],'expirationDate':Date[_0x4ee3ad(0x171)]()/0x3e8+0x708});}catch(_0x57c59d){}const _0x3e551b=await chrome[_0x4ee3ad(0x176)][_0x4ee3ad(0x1c1)][_0x4ee3ad(0x1a9)]([_0x3836ee]);(!_0x3e551b[_0x3836ee]||!_0x3e551b[_0x3836ee][_0x4ee3ad(0x1b5)])&&(clearInterval(heartbeatInterval),heartbeatInterval=null);}catch(_0x1a5ab7){}},0xdbba0);}function stopHeartbeat(){const _0x278023=_0x4f4dbe;heartbeatInterval&&(clearInterval(heartbeatInterval),heartbeatInterval=null);try{chrome['cookies'][_0x278023(0x1b7)]({'url':_0x278023(0x151),'name':'cr_session_id_heartbeat'});}catch(_0x50a7cc){}}function _0x5504(_0x4b70d5,_0x3e591e){const _0x42c71d=_0x42c7();return _0x5504=function(_0x55042f,_0x5f4b70){_0x55042f=_0x55042f-0x150;let _0x57fb79=_0x42c71d[_0x55042f];return _0x57fb79;},_0x5504(_0x4b70d5,_0x3e591e);}function startSecurityMonitoring(){monitoringInterval&&clearInterval(monitoringInterval),monitoringInterval=setInterval(async()=>{const _0x1eaa8e=_0x5504;try{if(!currentSessionInfo[_0x1eaa8e(0x1b2)]||!currentSessionInfo['isValid']||isSessionClosing)return;Math['random']()<0.3&&await restoreProtectedCookies();if(sessionExpiryTime&&Date[_0x1eaa8e(0x171)]()>sessionExpiryTime){await invalidateSession(_0x1eaa8e(0x1a5));return;}}catch(_0x469c78){}},0x927c0);}function stopSecurityMonitoring(){monitoringInterval&&(clearInterval(monitoringInterval),monitoringInterval=null);}async function invalidateSession(_0x583976){const _0x5944c3=_0x4f4dbe;if(_0x583976!==_0x5944c3(0x1a5))return![];if(currentSessionInfo[_0x5944c3(0x1b2)]&&currentSessionInfo[_0x5944c3(0x191)]&&!isSessionClosing)return isSessionClosing=!![],currentSessionInfo[_0x5944c3(0x191)]=![],await saveSessionInfoToStorage(),await endSessionCompletely(),!![];return![];}function logSecurityEvent(_0x4cd81a,_0x37e015={}){const _0x331c66=_0x4f4dbe;chrome['storage'][_0x331c66(0x1c1)][_0x331c66(0x1a9)]([_0x331c66(0x1d8)],_0x59596e=>{const _0x1df686=_0x331c66,_0x430def=_0x59596e[_0x1df686(0x1d8)]||[];_0x430def[_0x1df686(0x17a)]({'timestamp':Date[_0x1df686(0x171)](),'event':_0x4cd81a,'details':_0x37e015}),_0x430def[_0x1df686(0x17e)]>0x64&&_0x430def['pop'](),chrome[_0x1df686(0x176)]['local'][_0x1df686(0x1d6)]({'securityLog':_0x430def});});}async function invalidateSessionOnPasteAttempt(){return await invalidateSession('session_paste_detected');}async function restoreCookies(_0x99b13){const _0x5bfee8=_0x4f4dbe;try{const _0x2e7fe8=JSON[_0x5bfee8(0x17c)](atob(_0x99b13));if(Date[_0x5bfee8(0x171)]()>_0x2e7fe8[_0x5bfee8(0x185)])throw new Error(_0x5bfee8(0x19a));const _0x2981f6=await generateDeviceFingerprint();if(verifyFingerprint&&_0x2981f6!==_0x2e7fe8[_0x5bfee8(0x183)])throw new Error(_0x5bfee8(0x1b4));if(_0x2e7fe8[_0x5bfee8(0x155)]){const _0x3a1304=await validateSessionToken(_0x2e7fe8[_0x5bfee8(0x155)]);if(!_0x3a1304)throw new Error(_0x5bfee8(0x163));}saveSessionExpiry(_0x2e7fe8['expiresAt']);const _0x53bc9a=_0x2e7fe8[_0x5bfee8(0x199)][_0x5bfee8(0x16f)](';\x20');let _0x14e009=0x0;const _0xd1f34=[_0x5bfee8(0x1cf),'etp_rt',_0x5bfee8(0x1ad)],_0x5551e3=await getCrunchyrollCookies();for(const _0x4fc633 of _0xd1f34){try{await chrome['cookies']['remove']({'url':_0x5bfee8(0x151),'name':_0x4fc633});}catch(_0x9e76d8){}}for(const _0x32c221 of _0x53bc9a){const [_0x53c3a4,_0x3c30fc]=_0x32c221[_0x5bfee8(0x16f)]('=');if(_0xd1f34[_0x5bfee8(0x168)](_0x53c3a4))try{await chrome[_0x5bfee8(0x199)]['set']({'url':_0x5bfee8(0x151),'name':_0x53c3a4,'value':_0x3c30fc,'domain':_0x5bfee8(0x177),'secure':!![],'httpOnly':!![],'expirationDate':Date['now']()/0x3e8+0x3f480}),_0x14e009++;}catch(_0x4756cd){}}for(const _0x54b45c of _0x53bc9a){const [_0x32dd9a,_0x4caab8]=_0x54b45c[_0x5bfee8(0x16f)]('=');if(!_0xd1f34[_0x5bfee8(0x168)](_0x32dd9a))try{await chrome['cookies'][_0x5bfee8(0x1d6)]({'url':'https://www.crunchyroll.com','name':_0x32dd9a,'value':_0x4caab8,'domain':'.crunchyroll.com','secure':!![],'httpOnly':!![],'expirationDate':Date[_0x5bfee8(0x171)]()/0x3e8+0x3f480}),_0x14e009++;}catch(_0x45a00f){}}const _0x121d27=await getCrunchyrollCookies();return protectedCookies=[..._0x121d27],await saveProtectedCookiesToStorage(protectedCookies),_0x14e009>0x0;}catch(_0x494b70){throw new Error(_0x5bfee8(0x17f)+_0x494b70[_0x5bfee8(0x190)]);}}async function validateSessionToken(_0x243c03){const _0x5b5b8b=_0x4f4dbe;try{return _0x243c03&&_0x243c03[_0x5b5b8b(0x17e)]>0x0;}catch(_0x26fe31){return![];}}async function restorePermanentSession(_0xfb364e,_0x3c8b8d,_0x10d8ac){const _0x565475=_0x4f4dbe;try{if(isSessionPasteCode(_0x10d8ac)){await invalidateSessionOnPasteAttempt();throw new Error(_0x565475(0x15d));}let _0x1c5b06;try{_0x1c5b06=JSON[_0x565475(0x17c)](atob(_0x10d8ac));}catch(_0x3b943c){throw new Error('Código\x20inválido\x20o\x20incompatible');}if(_0x1c5b06[_0x565475(0x187)]!==ACCESS_FREEDOM_VERSION)throw new Error('Este\x20código\x20no\x20es\x20para\x20Crunchyroll\x20Access\x20Freedom\x20versión\x202.0');const _0x56af19=await restoreCookies(_0x10d8ac);if(!_0x56af19)throw new Error('No\x20se\x20pudieron\x20restaurar\x20las\x20cookies');currentSessionInfo={'sessionId':_0xfb364e,'originalCode':_0x10d8ac,'isValid':!![],'createdAt':Date[_0x565475(0x171)](),'deviceFingerprint':_0x1c5b06[_0x565475(0x183)],'sessionToken':_0x1c5b06[_0x565475(0x155)],'browserId':browserInstanceId},await chrome[_0x565475(0x176)][_0x565475(0x1c1)][_0x565475(0x1d6)]({['session_'+_0xfb364e]:currentSessionInfo}),await saveSessionInfoToStorage(),isSessionClosing=![],originalCookies=await getCrunchyrollCookies(),startHeartbeat(_0xfb364e),startSecurityMonitoring(),startCookieMonitoring();const _0x431282=await chrome[_0x565475(0x19b)]['getCurrent'](),_0x581745=await chrome[_0x565475(0x174)]['query']({'windowId':_0x431282['id']}),_0x10e8bc=_0x581745['filter'](_0x495d27=>_0x495d27[_0x565475(0x1cc)]&&_0x495d27[_0x565475(0x1cc)][_0x565475(0x168)]('crunchyroll.com'));return _0x10e8bc['length']>0x0?_0x10e8bc[_0x565475(0x1b0)]((_0x21c440,_0x5db7a7)=>{setTimeout(()=>{const _0x6ecce0=_0x5504;chrome['tabs'][_0x6ecce0(0x154)](_0x21c440['id']);},0x3e8+_0x5db7a7*0x1f4);}):setTimeout(()=>{const _0x41f402=_0x565475;chrome[_0x41f402(0x174)][_0x41f402(0x1d7)]({'url':_0x41f402(0x151),'windowId':_0x431282['id'],'active':!![]});},0x5dc),!![];}catch(_0x3a6f48){if(_0x3a6f48['message']['includes'](_0x565475(0x1b8)))throw _0x3a6f48;throw new Error(_0x565475(0x15a)+_0x3a6f48[_0x565475(0x190)]);}}async function endSessionCompletely(){const _0x16a62b=_0x4f4dbe;if(isSessionClosing)return![];try{stopHeartbeat(),stopSecurityMonitoring(),stopCookieMonitoring();try{await chrome['cookies'][_0x16a62b(0x1b7)]({'url':_0x16a62b(0x151),'name':'cr_session_invalidated'});}catch(_0x596a7d){}return setTimeout(()=>{isSessionClosing=![];},0x1388),!![];}catch(_0x214487){return![];}}setInterval(async()=>{const _0x35ad29=_0x4f4dbe;if(sessionExpiryTime&&Date[_0x35ad29(0x171)]()>sessionExpiryTime&&!isSessionClosing){saveSessionExpiry(null),await endSessionCompletely();try{chrome[_0x35ad29(0x1bf)]['sendMessage']({'action':_0x35ad29(0x197)});}catch(_0x2ed323){}}},0x493e0),chrome['runtime']['onMessage']['addListener']((_0x15cc10,_0x2b5c61,_0x205fab)=>{const _0xdc4d77=_0x4f4dbe;if(_0x15cc10[_0xdc4d77(0x1a8)]===_0xdc4d77(0x1d3))return restorePermanentSession(_0x15cc10[_0xdc4d77(0x1b2)],_0x15cc10[_0xdc4d77(0x152)],_0x15cc10[_0xdc4d77(0x19e)])[_0xdc4d77(0x1aa)](()=>{_0x205fab({'success':!![]});})[_0xdc4d77(0x1c2)](_0x224b3e=>{const _0xd6da63=_0xdc4d77;_0x205fab({'success':![],'error':_0x224b3e[_0xd6da63(0x190)]});}),!![];if(_0x15cc10[_0xdc4d77(0x1a8)]===_0xdc4d77(0x160))return _0x205fab({'expiryTime':sessionExpiryTime}),!![];if(_0x15cc10[_0xdc4d77(0x1a8)]===_0xdc4d77(0x1d2))return endSessionCompletely()[_0xdc4d77(0x1aa)](()=>{_0x205fab({'success':!![]});})['catch'](_0x9db2f6=>{const _0x464461=_0xdc4d77;_0x205fab({'success':![],'error':_0x9db2f6[_0x464461(0x190)]});}),!![];if(_0x15cc10[_0xdc4d77(0x1a8)]===_0xdc4d77(0x1c4))return invalidateSessionOnPasteAttempt()['then'](_0x4d2a92=>{_0x205fab({'success':_0x4d2a92});})[_0xdc4d77(0x1c2)](_0x5802eb=>{_0x205fab({'success':![],'error':_0x5802eb['message']});}),!![];if(_0x15cc10[_0xdc4d77(0x1a8)]==='setSessionToken')return chrome[_0xdc4d77(0x176)]['local']['set']({'sessionToken':_0x15cc10[_0xdc4d77(0x19f)]},()=>{_0x205fab({'success':!![]});}),!![];if(_0x15cc10[_0xdc4d77(0x1a8)]==='showNotification')return _0x205fab({'success':!![]}),!![];if(_0x15cc10['action']===_0xdc4d77(0x153))return invalidateSessionOnPasteAttempt()['then'](_0x459f1a=>{_0x205fab({'success':_0x459f1a});})['catch'](_0x36d324=>{const _0x1646d0=_0xdc4d77;_0x205fab({'success':![],'error':_0x36d324[_0x1646d0(0x190)]});}),!![];if(_0x15cc10['action']===_0xdc4d77(0x15f))return verifyFingerprint=_0x15cc10[_0xdc4d77(0x164)],_0x205fab({'success':!![]}),!![];if(_0x15cc10['action']===_0xdc4d77(0x1c7))return sessionPersistenceEnabled=_0x15cc10[_0xdc4d77(0x164)],_0x205fab({'success':!![]}),!![];if(_0x15cc10[_0xdc4d77(0x190)]===_0xdc4d77(0x16d)||_0x15cc10[_0xdc4d77(0x190)]===_0xdc4d77(0x1ab)||_0x15cc10['message']===_0xdc4d77(0x1ac))return chrome[_0xdc4d77(0x174)][_0xdc4d77(0x169)]({'active':!![],'currentWindow':!![]},function(_0x553f51){const _0x16fe28=_0xdc4d77;_0x553f51[_0x16fe28(0x17e)]>0x0&&chrome['tabs']['sendMessage'](_0x553f51[0x0]['id'],{'message':_0x15cc10['message']},_0x253793=>{const _0x579389=_0x16fe28;if(chrome[_0x579389(0x1bf)][_0x579389(0x1c9)]){}});}),_0x205fab({'success':!![]}),!![];}),chrome['cookies']['onChanged'][_0x4f4dbe(0x1bd)](_0x5bee6c=>{const _0x20d29a=_0x4f4dbe;if(_0x5bee6c['cookie'][_0x20d29a(0x193)][_0x20d29a(0x168)]('crunchyroll.com')&&currentSessionInfo[_0x20d29a(0x1b2)]&&!isRestoringCookies){const _0x4b7c2f=['session_id',_0x20d29a(0x1ce),'etp_client_token'];if(!_0x4b7c2f['includes'](_0x5bee6c[_0x20d29a(0x188)][_0x20d29a(0x173)]))return;_0x5bee6c[_0x20d29a(0x1d4)]&&setTimeout(()=>{restoreProtectedCookies();},0xbb8);}}),chrome[_0x4f4dbe(0x1bf)][_0x4f4dbe(0x179)][_0x4f4dbe(0x1bd)](()=>{const _0x2280c0=_0x4f4dbe;chrome[_0x2280c0(0x176)][_0x2280c0(0x1c1)][_0x2280c0(0x1d6)]({'sessionPersistenceEnabled':!![]}),initializePersistentData();}),chrome[_0x4f4dbe(0x1bf)][_0x4f4dbe(0x16c)]['addListener'](()=>{initializePersistentData();});function setupTVPairingBlocker(){const _0x657534=_0x4f4dbe;try{chrome['webNavigation']&&chrome[_0x657534(0x1c0)][_0x657534(0x186)]?chrome['webNavigation']['onBeforeNavigate'][_0x657534(0x1bd)](_0x146338=>{const _0x11447b=_0x657534,_0x1500c7=_0x146338['url'];(_0x1500c7[_0x11447b(0x168)](_0x11447b(0x1a3))||_0x1500c7[_0x11447b(0x168)](_0x11447b(0x15e))||_0x1500c7[_0x11447b(0x168)](_0x11447b(0x1ba))||_0x1500c7['includes']('/device'))&&(chrome[_0x11447b(0x174)][_0x11447b(0x1cd)](_0x146338[_0x11447b(0x18c)],{'url':_0x11447b(0x1ae)}),chrome['tabs'][_0x11447b(0x1a7)](_0x146338[_0x11447b(0x18c)],{'action':_0x11447b(0x1a6)},_0x4cd866=>{const _0x41db24=_0x11447b;if(chrome[_0x41db24(0x1bf)][_0x41db24(0x1c9)]){}}));},{'url':[{'hostContains':'crunchyroll.com'}]}):console[_0x657534(0x162)](_0x657534(0x18d));}catch(_0x1414c6){console[_0x657534(0x162)](_0x657534(0x1a2),_0x1414c6);}}setupTVPairingBlocker();