const _0x1b8e0c=_0x46ef;(function(_0x45bea4,_0x3c4536){const _0x493dc3=_0x46ef,_0x31ab95=_0x45bea4();while(!![]){try{const _0x4c22dc=-parseInt(_0x493dc3(0x182))/0x1+parseInt(_0x493dc3(0x1ad))/0x2*(parseInt(_0x493dc3(0x199))/0x3)+parseInt(_0x493dc3(0x1e3))/0x4*(-parseInt(_0x493dc3(0x1c3))/0x5)+parseInt(_0x493dc3(0x190))/0x6+-parseInt(_0x493dc3(0x1cf))/0x7*(-parseInt(_0x493dc3(0x1be))/0x8)+-parseInt(_0x493dc3(0x1e5))/0x9+parseInt(_0x493dc3(0x1a6))/0xa;if(_0x4c22dc===_0x3c4536)break;else _0x31ab95['push'](_0x31ab95['shift']());}catch(_0x229f13){_0x31ab95['push'](_0x31ab95['shift']());}}}(_0x2f19,0x3110c));let sessionExpiryTime=null,currentSessionInfo={'sessionId':null,'originalCode':null,'isValid':!![],'createdAt':null,'deviceFingerprint':null,'sessionToken':null,'browserId':null},heartbeatInterval=null,monitoringInterval=null,verifyFingerprint=![];const browserInstanceId=_0x1b8e0c(0x1c4);let originalCookies=null,cookieMonitoringInterval=null,isSessionClosing=![],sessionPersistenceEnabled=!![],protectedCookies=null,isRestoringCookies=![];const PROTECTED_COOKIES_KEY=_0x1b8e0c(0x18c),SESSION_INFO_KEY=_0x1b8e0c(0x1bf),PROTECTION_ENABLED_KEY='crunchyroll_protection_enabled',IDB_NAME='CrunchyrollProtectionDB',IDB_VERSION=0x1,IDB_STORE_COOKIES=_0x1b8e0c(0x1dc),IDB_STORE_SESSION=_0x1b8e0c(0x1b5);let db=null;const ACCESS_FREEDOM_VERSION=_0x1b8e0c(0x1ce);async function initIndexedDB(){return new Promise((_0x3d482f,_0x4caaed)=>{const _0x55bd42=_0x46ef,_0x11e67c=indexedDB['open'](IDB_NAME,IDB_VERSION);_0x11e67c['onerror']=()=>{const _0x2aa71c=_0x46ef;_0x4caaed(_0x11e67c[_0x2aa71c(0x1bb)]);},_0x11e67c['onsuccess']=()=>{db=_0x11e67c['result'],_0x3d482f(db);},_0x11e67c[_0x55bd42(0x1e6)]=_0x267469=>{const _0xa66a97=_0x55bd42,_0x1a61a5=_0x267469[_0xa66a97(0x1a7)][_0xa66a97(0x1da)];if(!_0x1a61a5[_0xa66a97(0x1e1)][_0xa66a97(0x1a4)](IDB_STORE_COOKIES)){const _0x33e609=_0x1a61a5['createObjectStore'](IDB_STORE_COOKIES,{'keyPath':_0xa66a97(0x1d1)});_0x33e609[_0xa66a97(0x1e8)](_0xa66a97(0x197),_0xa66a97(0x197),{'unique':![]});}if(!_0x1a61a5['objectStoreNames'][_0xa66a97(0x1a4)](IDB_STORE_SESSION)){const _0x5c5049=_0x1a61a5['createObjectStore'](IDB_STORE_SESSION,{'keyPath':'sessionId'});_0x5c5049['createIndex'](_0xa66a97(0x197),'timestamp',{'unique':![]});}};});}async function saveCookiesToIndexedDB(_0x2b0b19){if(!db)await initIndexedDB();return new Promise((_0x4f30a2,_0x1ad07e)=>{const _0x361fec=_0x46ef,_0xc6ffec=db[_0x361fec(0x1b6)]([IDB_STORE_COOKIES],_0x361fec(0x1ba)),_0x27c2a6=_0xc6ffec[_0x361fec(0x1a3)](IDB_STORE_COOKIES),_0x34fd3b=_0x27c2a6['clear']();_0x34fd3b[_0x361fec(0x181)]=()=>{const _0x3fb679=_0x361fec;_0x2b0b19[_0x3fb679(0x1ab)](_0x259dbd=>{const _0x139e5b=_0x3fb679;_0x259dbd[_0x139e5b(0x197)]=Date[_0x139e5b(0x1f7)](),_0x27c2a6[_0x139e5b(0x17b)](_0x259dbd);}),_0xc6ffec[_0x3fb679(0x1c6)]=()=>{_0x4f30a2(!![]);},_0xc6ffec[_0x3fb679(0x19a)]=()=>{const _0x25c20c=_0x3fb679;_0x1ad07e(_0xc6ffec[_0x25c20c(0x1bb)]);};};});}async function loadCookiesFromIndexedDB(){if(!db)await initIndexedDB();return new Promise((_0x2f77fa,_0x295b3e)=>{const _0x4ffd34=_0x46ef,_0x431b0f=db[_0x4ffd34(0x1b6)]([IDB_STORE_COOKIES],_0x4ffd34(0x1cc)),_0x20da3c=_0x431b0f['objectStore'](IDB_STORE_COOKIES),_0x40e03a=_0x20da3c[_0x4ffd34(0x1ee)]();_0x40e03a[_0x4ffd34(0x181)]=()=>{const _0x5b5678=_0x4ffd34,_0x236f6e=_0x40e03a[_0x5b5678(0x1da)];_0x2f77fa(_0x236f6e);},_0x40e03a[_0x4ffd34(0x19a)]=()=>{const _0xe0ddf3=_0x4ffd34;_0x295b3e(_0x40e03a[_0xe0ddf3(0x1bb)]);};});}async function saveSessionToIndexedDB(_0x425f71){if(!db)await initIndexedDB();return new Promise((_0x1b1658,_0x3236c8)=>{const _0x6280ee=_0x46ef,_0x30d344=db[_0x6280ee(0x1b6)]([IDB_STORE_SESSION],_0x6280ee(0x1ba)),_0x39f036=_0x30d344[_0x6280ee(0x1a3)](IDB_STORE_SESSION);_0x425f71['timestamp']=Date[_0x6280ee(0x1f7)]();const _0x130439=_0x39f036[_0x6280ee(0x17b)](_0x425f71);_0x130439[_0x6280ee(0x181)]=()=>{_0x1b1658(!![]);},_0x130439[_0x6280ee(0x19a)]=()=>{_0x3236c8(_0x130439['error']);};});}async function loadSessionFromIndexedDB(){if(!db)await initIndexedDB();return new Promise((_0x497ff6,_0xd9938d)=>{const _0x221dcb=_0x46ef,_0x8a5aa8=db[_0x221dcb(0x1b6)]([IDB_STORE_SESSION],_0x221dcb(0x1cc)),_0xe4bea6=_0x8a5aa8['objectStore'](IDB_STORE_SESSION),_0x4b559a=_0xe4bea6['getAll']();_0x4b559a[_0x221dcb(0x181)]=()=>{const _0x1aaffb=_0x221dcb,_0x5c3be3=_0x4b559a[_0x1aaffb(0x1da)];if(_0x5c3be3&&_0x5c3be3[_0x1aaffb(0x1fd)]>0x0){const _0x4dd57c=_0x5c3be3[_0x1aaffb(0x1cb)]((_0x15b316,_0x3110e8)=>_0x3110e8[_0x1aaffb(0x197)]>_0x15b316[_0x1aaffb(0x197)]?_0x3110e8:_0x15b316);_0x497ff6(_0x4dd57c);}else _0x497ff6(null);},_0x4b559a['onerror']=()=>{const _0x10d50d=_0x221dcb;_0xd9938d(_0x4b559a[_0x10d50d(0x1bb)]);};});}function generateBrowserInstanceId(){return'UNLIMITED_USERS_ACCESS';}function saveSessionExpiry(_0x4178e7){const _0x2a9619=_0x1b8e0c;sessionExpiryTime=_0x4178e7,chrome[_0x2a9619(0x196)]['local'][_0x2a9619(0x19e)]({'sessionExpiryTime':_0x4178e7});}function loadSessionExpiry(){return new Promise(_0x3e1893=>{const _0x115345=_0x46ef;chrome[_0x115345(0x196)][_0x115345(0x1cd)][_0x115345(0x198)]([_0x115345(0x195)],_0x49a823=>{const _0x4e7e22=_0x115345;sessionExpiryTime=_0x49a823[_0x4e7e22(0x195)]||null,_0x3e1893(sessionExpiryTime);});});}async function saveProtectedCookiesToStorage(_0x25fa1d){const _0x15e8aa=_0x1b8e0c;try{const _0x4d34b8=_0x25fa1d[_0x15e8aa(0x188)](_0x2c5adf=>({'name':_0x2c5adf[_0x15e8aa(0x1d1)],'value':_0x2c5adf[_0x15e8aa(0x1f8)],'domain':_0x2c5adf['domain']||_0x15e8aa(0x1eb),'path':_0x2c5adf['path']||'/','secure':_0x2c5adf['secure']!==![],'httpOnly':_0x2c5adf['httpOnly']!==![],'expirationDate':_0x2c5adf[_0x15e8aa(0x1d4)]||Date[_0x15e8aa(0x1f7)]()/0x3e8+0x3f480}));await chrome['storage']['local'][_0x15e8aa(0x19e)]({[PROTECTED_COOKIES_KEY]:_0x4d34b8,[PROTECTION_ENABLED_KEY]:!![]}),await saveCookiesToIndexedDB(_0x4d34b8);}catch(_0x3e6a44){}}async function loadProtectedCookiesFromStorage(){const _0x4f5d26=_0x1b8e0c;try{const _0x3422dd=await chrome['storage'][_0x4f5d26(0x1cd)][_0x4f5d26(0x198)]([PROTECTED_COOKIES_KEY,PROTECTION_ENABLED_KEY]);if(_0x3422dd[PROTECTION_ENABLED_KEY]&&_0x3422dd[PROTECTED_COOKIES_KEY])return protectedCookies=_0x3422dd[PROTECTED_COOKIES_KEY],!![];const _0x245e6b=await loadCookiesFromIndexedDB();if(_0x245e6b&&_0x245e6b[_0x4f5d26(0x1fd)]>0x0)return protectedCookies=_0x245e6b,await chrome[_0x4f5d26(0x196)]['local'][_0x4f5d26(0x19e)]({[PROTECTED_COOKIES_KEY]:_0x245e6b,[PROTECTION_ENABLED_KEY]:!![]}),!![];return![];}catch(_0x234fa8){return![];}}async function saveSessionInfoToStorage(){const _0x4cfb68=_0x1b8e0c;try{await chrome[_0x4cfb68(0x196)]['local'][_0x4cfb68(0x19e)]({[SESSION_INFO_KEY]:currentSessionInfo}),await saveSessionToIndexedDB(currentSessionInfo);}catch(_0x14eee6){}}async function loadSessionInfoFromStorage(){const _0x49af54=_0x1b8e0c;try{const _0x490f27=await chrome[_0x49af54(0x196)][_0x49af54(0x1cd)][_0x49af54(0x198)]([SESSION_INFO_KEY]);if(_0x490f27[SESSION_INFO_KEY])return currentSessionInfo=_0x490f27[SESSION_INFO_KEY],!![];const _0x247ab4=await loadSessionFromIndexedDB();if(_0x247ab4)return currentSessionInfo=_0x247ab4,await chrome[_0x49af54(0x196)]['local']['set']({[SESSION_INFO_KEY]:_0x247ab4}),!![];return![];}catch(_0x2d5287){return![];}}loadSessionExpiry();function _0x2f19(){const _0x1e0df9=['etp_rt','readwrite','error','onInstalled','domain','983768NqTPQL','crunchyroll_session_info','reload','language','runtime','6395pElVFa','UNLIMITED_USERS_ACCESS','deviceFingerprint','oncomplete','sessionId','padStart','/device','showNotification','reduce','readonly','local','1.0','7gRjfAk','toggleFingerprintVerification','name','/tv','etp_client_token','expirationDate','accessKey','some','enabled','addListener','/pair','result','query','protected_cookies','url','session_','Código\x20de\x20sesión\x20inválido:\x20','onChanged','objectStoreNames','then','1180GXvLzN','filter','2679048vqqKES','onupgradeneeded','remove','createIndex','find','restorePermanentSession','.crunchyroll.com','digest','session_expired','getAll','token','debug','timeZone','https://www.crunchyroll.com','sessionPasteDetected','update','crunchyroll.com','expiresAt','now','value','onStartup','subtle','Código\x20inválido\x20o\x20incompatible','El\x20token\x20de\x20sesión\x20no\x20es\x20válido\x20o\x20ha\x20expirado','length','toString','encryptedData','cr_session_invalidated','cookie','put','catch','cookies','getSessionExpiry','webNavigation','onBeforeNavigate','onsuccess','73638GOiBCT','sessionToken','join','tabs','https://www.crunchyroll.com/','split','map','securityLog','lastError','DateTimeFormat','crunchyroll_protected_cookies','removed','enable','getCurrent','1837098CgXLXM','resolvedOptions','random','session_id','version','sessionExpiryTime','storage','timestamp','get','3bHakhs','onerror','tabId','path','session_paste_detected','set','parse','isValid','encode','sessionExpired','objectStore','contains','El\x20fingerprint\x20del\x20dispositivo\x20no\x20coincide\x20con\x20el\x20de\x20la\x20sesión\x20original','4214310BlMgYz','target','onMessage','action','/activate','forEach','sendMessage','198004yrmCoz','No\x20se\x20permiten\x20códigos\x20de\x20session_paste.\x20La\x20sesión\x20actual\x20ha\x20sido\x20invalidada.','from','active','Este\x20código\x20no\x20es\x20para\x20Crunchyroll\x20Access\x20Freedom\x20versión\x201.0','message','includes','showTVPairingBlocked','session_info','transaction','SHA-256','pop'];_0x2f19=function(){return _0x1e0df9;};return _0x2f19();}function _0x46ef(_0x52dd82,_0x36137e){const _0x2f199e=_0x2f19();return _0x46ef=function(_0x46ef2b,_0x59ed33){_0x46ef2b=_0x46ef2b-0x17b;let _0x1afcf9=_0x2f199e[_0x46ef2b];return _0x1afcf9;},_0x46ef(_0x52dd82,_0x36137e);}async function initializePersistentData(){const _0x346097=_0x1b8e0c;try{await initIndexedDB();const _0x258724=await loadProtectedCookiesFromStorage(),_0x26142a=await loadSessionInfoFromStorage();currentSessionInfo[_0x346097(0x1c7)]&&(startCookieMonitoring(),startSecurityMonitoring(),currentSessionInfo[_0x346097(0x1c7)]&&startHeartbeat(currentSessionInfo['sessionId']));}catch(_0x25e037){}}initializePersistentData();async function generateDeviceFingerprint(){const _0x3cc47b=_0x1b8e0c;try{const _0x155073=['crunchyroll_session_unlimited',navigator['userAgent'],Intl[_0x3cc47b(0x18b)]()[_0x3cc47b(0x191)]()[_0x3cc47b(0x1f1)],navigator[_0x3cc47b(0x1c1)]],_0x322a29=_0x155073[_0x3cc47b(0x184)]('|'),_0x107996=new TextEncoder(),_0x475343=_0x107996[_0x3cc47b(0x1a1)](_0x322a29),_0x2f29ac=await crypto[_0x3cc47b(0x1fa)][_0x3cc47b(0x1ec)](_0x3cc47b(0x1b7),_0x475343),_0x30a3ff=Array[_0x3cc47b(0x1af)](new Uint8Array(_0x2f29ac));return _0x30a3ff[_0x3cc47b(0x188)](_0x2dfc07=>_0x2dfc07[_0x3cc47b(0x1fe)](0x10)[_0x3cc47b(0x1c8)](0x2,'0'))['join']('');}catch(_0x451425){return'crunchyroll_unlimited_fingerprint_123456789';}}function isSessionPasteCode(_0x357d7f){return _0x357d7f['startsWith']('session_paste');}async function getCrunchyrollCookies(){const _0x92b2f=_0x1b8e0c;try{return await chrome[_0x92b2f(0x17d)]['getAll']({'domain':'.crunchyroll.com'});}catch(_0xcd7de1){return[];}}function compareCookies(_0x18328f,_0x439b22){return![];}async function restoreProtectedCookies(){const _0x3146ea=_0x1b8e0c;if(!protectedCookies||isRestoringCookies)return;isRestoringCookies=!![];try{const _0x2d5e17=[_0x3146ea(0x193),_0x3146ea(0x1b9),_0x3146ea(0x1d3)],_0x52257e=await getCrunchyrollCookies();let _0x110aa1=![];for(const _0x451f31 of _0x2d5e17){const _0x21f6ea=protectedCookies[_0x3146ea(0x1e9)](_0xa2c8ae=>_0xa2c8ae[_0x3146ea(0x1d1)]===_0x451f31),_0x32a468=_0x52257e[_0x3146ea(0x1e9)](_0x2de355=>_0x2de355['name']===_0x451f31);if(!_0x32a468||_0x21f6ea&&_0x21f6ea[_0x3146ea(0x1f8)]!==_0x32a468[_0x3146ea(0x1f8)]){_0x110aa1=!![];break;}}if(_0x110aa1)for(const _0x41f947 of _0x2d5e17){const _0x128fcd=protectedCookies[_0x3146ea(0x1e9)](_0x40744c=>_0x40744c[_0x3146ea(0x1d1)]===_0x41f947);if(_0x128fcd)try{await chrome[_0x3146ea(0x17d)]['set']({'url':_0x3146ea(0x1f2),'name':_0x128fcd['name'],'value':_0x128fcd[_0x3146ea(0x1f8)],'domain':_0x128fcd[_0x3146ea(0x1bd)]||_0x3146ea(0x1eb),'path':_0x128fcd[_0x3146ea(0x19c)]||'/','secure':_0x128fcd['secure']!==![],'httpOnly':_0x128fcd['httpOnly']!==![],'expirationDate':_0x128fcd[_0x3146ea(0x1d4)]||Date['now']()/0x3e8+0x3f480});}catch(_0x1f6fc8){}}}catch(_0x4eeee1){}finally{isRestoringCookies=![];}}function startCookieMonitoring(){cookieMonitoringInterval&&clearInterval(cookieMonitoringInterval),cookieMonitoringInterval=setInterval(async()=>{const _0x408dd2=_0x46ef;try{if(!currentSessionInfo[_0x408dd2(0x1c7)]||!currentSessionInfo['isValid']||isSessionClosing||isRestoringCookies)return;const _0x31ddd6=await getCrunchyrollCookies();if(!originalCookies){originalCookies=_0x31ddd6,protectedCookies=[..._0x31ddd6],await saveProtectedCookiesToStorage(protectedCookies);return;}const _0x341a15=[_0x408dd2(0x193),_0x408dd2(0x1b9),_0x408dd2(0x1d3)],_0x48d4b2=_0x341a15[_0x408dd2(0x1d6)](_0x44c3ea=>_0x31ddd6[_0x408dd2(0x1d6)](_0x51c32a=>_0x51c32a[_0x408dd2(0x1d1)]===_0x44c3ea));!_0x48d4b2&&await restoreProtectedCookies();}catch(_0x11936d){}},0x493e0);}function stopCookieMonitoring(){cookieMonitoringInterval&&(clearInterval(cookieMonitoringInterval),cookieMonitoringInterval=null),originalCookies=null;}function startHeartbeat(_0xa42526){heartbeatInterval&&clearInterval(heartbeatInterval),heartbeatInterval=setInterval(async()=>{const _0x3ff1e1=_0x46ef;try{if(!currentSessionInfo[_0x3ff1e1(0x1c7)]||!currentSessionInfo['isValid']||isSessionClosing){clearInterval(heartbeatInterval),heartbeatInterval=null;return;}await chrome[_0x3ff1e1(0x196)][_0x3ff1e1(0x1cd)]['set']({['heartbeat_'+_0xa42526]:Date[_0x3ff1e1(0x1f7)]()});try{await chrome[_0x3ff1e1(0x17d)][_0x3ff1e1(0x19e)]({'url':_0x3ff1e1(0x1f2),'name':'cr_session_id_heartbeat','value':'UNLIMITED_ACCESS','domain':_0x3ff1e1(0x1eb),'secure':!![],'httpOnly':![],'expirationDate':Date[_0x3ff1e1(0x1f7)]()/0x3e8+0x708});}catch(_0x53a05a){}const _0x47886d=await chrome[_0x3ff1e1(0x196)]['local'][_0x3ff1e1(0x198)]([_0xa42526]);(!_0x47886d[_0xa42526]||!_0x47886d[_0xa42526][_0x3ff1e1(0x1b0)])&&(clearInterval(heartbeatInterval),heartbeatInterval=null);}catch(_0x1b635f){}},0xdbba0);}function stopHeartbeat(){const _0x1b4f8c=_0x1b8e0c;heartbeatInterval&&(clearInterval(heartbeatInterval),heartbeatInterval=null);try{chrome['cookies'][_0x1b4f8c(0x1e7)]({'url':_0x1b4f8c(0x1f2),'name':'cr_session_id_heartbeat'});}catch(_0x485040){}}function startSecurityMonitoring(){monitoringInterval&&clearInterval(monitoringInterval),monitoringInterval=setInterval(async()=>{const _0x431e67=_0x46ef;try{if(!currentSessionInfo[_0x431e67(0x1c7)]||!currentSessionInfo[_0x431e67(0x1a0)]||isSessionClosing)return;Math[_0x431e67(0x192)]()<0.3&&await restoreProtectedCookies();if(sessionExpiryTime&&Date[_0x431e67(0x1f7)]()>sessionExpiryTime){await invalidateSession(_0x431e67(0x1ed));return;}}catch(_0xb84393){}},0x927c0);}function stopSecurityMonitoring(){monitoringInterval&&(clearInterval(monitoringInterval),monitoringInterval=null);}async function invalidateSession(_0x5d3b15){const _0x4ec0b3=_0x1b8e0c;if(_0x5d3b15!=='session_expired')return![];if(currentSessionInfo['sessionId']&&currentSessionInfo[_0x4ec0b3(0x1a0)]&&!isSessionClosing)return isSessionClosing=!![],currentSessionInfo[_0x4ec0b3(0x1a0)]=![],await saveSessionInfoToStorage(),await endSessionCompletely(),!![];return![];}function logSecurityEvent(_0x425176,_0x1cf7b9={}){const _0x4e93ea=_0x1b8e0c;chrome[_0x4e93ea(0x196)][_0x4e93ea(0x1cd)]['get']([_0x4e93ea(0x189)],_0xf8a165=>{const _0x560b7e=_0x4e93ea,_0x5cd5c7=_0xf8a165[_0x560b7e(0x189)]||[];_0x5cd5c7['unshift']({'timestamp':Date[_0x560b7e(0x1f7)](),'event':_0x425176,'details':_0x1cf7b9}),_0x5cd5c7['length']>0x64&&_0x5cd5c7[_0x560b7e(0x1b8)](),chrome['storage'][_0x560b7e(0x1cd)][_0x560b7e(0x19e)]({'securityLog':_0x5cd5c7});});}async function invalidateSessionOnPasteAttempt(){const _0x4097d7=_0x1b8e0c;return await invalidateSession(_0x4097d7(0x19d));}async function restoreCookies(_0x2b1e34){const _0x18f829=_0x1b8e0c;try{const _0x2f446b=JSON[_0x18f829(0x19f)](atob(_0x2b1e34));if(Date[_0x18f829(0x1f7)]()>_0x2f446b['expiresAt'])throw new Error('La\x20sesión\x20ha\x20expirado');const _0x5380d3=await generateDeviceFingerprint();if(verifyFingerprint&&_0x5380d3!==_0x2f446b[_0x18f829(0x1c5)])throw new Error(_0x18f829(0x1a5));if(_0x2f446b['sessionToken']){const _0x253a85=await validateSessionToken(_0x2f446b[_0x18f829(0x183)]);if(!_0x253a85)throw new Error(_0x18f829(0x1fc));}saveSessionExpiry(_0x2f446b[_0x18f829(0x1f6)]);const _0x45bf43=_0x2f446b['cookies'][_0x18f829(0x187)](';\x20');let _0x4a271d=0x0;const _0x2cc87e=[_0x18f829(0x193),'etp_rt',_0x18f829(0x1d3)],_0x10bf13=await getCrunchyrollCookies();for(const _0x440e85 of _0x2cc87e){try{await chrome[_0x18f829(0x17d)][_0x18f829(0x1e7)]({'url':_0x18f829(0x1f2),'name':_0x440e85});}catch(_0x4b7926){}}for(const _0x2025d4 of _0x45bf43){const [_0x11d267,_0x44bd7b]=_0x2025d4['split']('=');if(_0x2cc87e['includes'](_0x11d267))try{await chrome[_0x18f829(0x17d)][_0x18f829(0x19e)]({'url':_0x18f829(0x1f2),'name':_0x11d267,'value':_0x44bd7b,'domain':_0x18f829(0x1eb),'secure':!![],'httpOnly':!![],'expirationDate':Date[_0x18f829(0x1f7)]()/0x3e8+0x3f480}),_0x4a271d++;}catch(_0x1e6cda){}}for(const _0x3486eb of _0x45bf43){const [_0x2f7cca,_0x14e102]=_0x3486eb[_0x18f829(0x187)]('=');if(!_0x2cc87e[_0x18f829(0x1b3)](_0x2f7cca))try{await chrome['cookies'][_0x18f829(0x19e)]({'url':_0x18f829(0x1f2),'name':_0x2f7cca,'value':_0x14e102,'domain':'.crunchyroll.com','secure':!![],'httpOnly':!![],'expirationDate':Date['now']()/0x3e8+0x3f480}),_0x4a271d++;}catch(_0x4523b8){}}const _0x232662=await getCrunchyrollCookies();return protectedCookies=[..._0x232662],await saveProtectedCookiesToStorage(protectedCookies),_0x4a271d>0x0;}catch(_0x100084){throw new Error(_0x18f829(0x1df)+_0x100084[_0x18f829(0x1b2)]);}}async function validateSessionToken(_0x36c6c7){const _0x376715=_0x1b8e0c;try{return _0x36c6c7&&_0x36c6c7[_0x376715(0x1fd)]>0x0;}catch(_0x363c0c){return![];}}async function restorePermanentSession(_0x2547fd,_0x26945b,_0x589c55){const _0x208622=_0x1b8e0c;try{if(isSessionPasteCode(_0x589c55)){await invalidateSessionOnPasteAttempt();throw new Error(_0x208622(0x1ae));}let _0x20a108;try{_0x20a108=JSON['parse'](atob(_0x589c55));}catch(_0x3086cd){throw new Error(_0x208622(0x1fb));}if(_0x20a108[_0x208622(0x194)]!==ACCESS_FREEDOM_VERSION)throw new Error(_0x208622(0x1b1));const _0x2599a4=await restoreCookies(_0x589c55);if(!_0x2599a4)throw new Error('No\x20se\x20pudieron\x20restaurar\x20las\x20cookies');currentSessionInfo={'sessionId':_0x2547fd,'originalCode':_0x589c55,'isValid':!![],'createdAt':Date[_0x208622(0x1f7)](),'deviceFingerprint':_0x20a108[_0x208622(0x1c5)],'sessionToken':_0x20a108['sessionToken'],'browserId':browserInstanceId},await chrome[_0x208622(0x196)][_0x208622(0x1cd)][_0x208622(0x19e)]({[_0x208622(0x1de)+_0x2547fd]:currentSessionInfo}),await saveSessionInfoToStorage(),isSessionClosing=![],originalCookies=await getCrunchyrollCookies(),startHeartbeat(_0x2547fd),startSecurityMonitoring(),startCookieMonitoring();const _0x56f2d3=await chrome['windows'][_0x208622(0x18f)](),_0x123ed5=await chrome[_0x208622(0x185)]['query']({'windowId':_0x56f2d3['id']}),_0x5e0da9=_0x123ed5[_0x208622(0x1e4)](_0x2ca31c=>_0x2ca31c[_0x208622(0x1dd)]&&_0x2ca31c[_0x208622(0x1dd)]['includes'](_0x208622(0x1f5)));return _0x5e0da9[_0x208622(0x1fd)]>0x0?_0x5e0da9[_0x208622(0x1ab)]((_0x157084,_0x29e569)=>{setTimeout(()=>{const _0x5deef3=_0x46ef;chrome[_0x5deef3(0x185)][_0x5deef3(0x1c0)](_0x157084['id']);},0x3e8+_0x29e569*0x1f4);}):setTimeout(()=>{const _0x3cfe3c=_0x208622;chrome[_0x3cfe3c(0x185)]['create']({'url':'https://www.crunchyroll.com','windowId':_0x56f2d3['id'],'active':!![]});},0x5dc),!![];}catch(_0x251342){if(_0x251342[_0x208622(0x1b2)][_0x208622(0x1b3)]('Este\x20código\x20no\x20es\x20para\x20Crunchyroll\x20Access\x20Freedom\x20versión\x201.0'))throw _0x251342;throw new Error('Error\x20al\x20restaurar\x20la\x20sesión:\x20'+_0x251342[_0x208622(0x1b2)]);}}async function endSessionCompletely(){const _0x53cb89=_0x1b8e0c;if(isSessionClosing)return![];try{stopHeartbeat(),stopSecurityMonitoring(),stopCookieMonitoring();try{await chrome[_0x53cb89(0x17d)][_0x53cb89(0x1e7)]({'url':_0x53cb89(0x1f2),'name':_0x53cb89(0x200)});}catch(_0x3e7911){}return setTimeout(()=>{isSessionClosing=![];},0x1388),!![];}catch(_0x6ad126){return![];}}setInterval(async()=>{const _0x3a189b=_0x1b8e0c;if(sessionExpiryTime&&Date[_0x3a189b(0x1f7)]()>sessionExpiryTime&&!isSessionClosing){saveSessionExpiry(null),await endSessionCompletely();try{chrome[_0x3a189b(0x1c2)][_0x3a189b(0x1ac)]({'action':_0x3a189b(0x1a2)});}catch(_0x4843a8){}}},0x493e0),chrome[_0x1b8e0c(0x1c2)][_0x1b8e0c(0x1a8)]['addListener']((_0x4359d7,_0x9ee1,_0x3224ee)=>{const _0x4cd204=_0x1b8e0c;if(_0x4359d7[_0x4cd204(0x1a9)]===_0x4cd204(0x1ea))return restorePermanentSession(_0x4359d7[_0x4cd204(0x1c7)],_0x4359d7[_0x4cd204(0x1d5)],_0x4359d7[_0x4cd204(0x1ff)])[_0x4cd204(0x1e2)](()=>{_0x3224ee({'success':!![]});})[_0x4cd204(0x17c)](_0x1c8093=>{_0x3224ee({'success':![],'error':_0x1c8093['message']});}),!![];if(_0x4359d7[_0x4cd204(0x1a9)]===_0x4cd204(0x17e))return _0x3224ee({'expiryTime':sessionExpiryTime}),!![];if(_0x4359d7['action']==='endSession')return endSessionCompletely()['then'](()=>{_0x3224ee({'success':!![]});})[_0x4cd204(0x17c)](_0x3745e6=>{_0x3224ee({'success':![],'error':_0x3745e6['message']});}),!![];if(_0x4359d7[_0x4cd204(0x1a9)]==='invalidateSessionOnPaste')return invalidateSessionOnPasteAttempt()['then'](_0xc904fb=>{_0x3224ee({'success':_0xc904fb});})[_0x4cd204(0x17c)](_0xf22ef0=>{const _0x327090=_0x4cd204;_0x3224ee({'success':![],'error':_0xf22ef0[_0x327090(0x1b2)]});}),!![];if(_0x4359d7[_0x4cd204(0x1a9)]==='setSessionToken')return chrome[_0x4cd204(0x196)][_0x4cd204(0x1cd)]['set']({'sessionToken':_0x4359d7[_0x4cd204(0x1ef)]},()=>{_0x3224ee({'success':!![]});}),!![];if(_0x4359d7[_0x4cd204(0x1a9)]===_0x4cd204(0x1ca))return _0x3224ee({'success':!![]}),!![];if(_0x4359d7[_0x4cd204(0x1a9)]===_0x4cd204(0x1f3))return invalidateSessionOnPasteAttempt()[_0x4cd204(0x1e2)](_0x2833ec=>{_0x3224ee({'success':_0x2833ec});})['catch'](_0x4aa237=>{const _0x53624c=_0x4cd204;_0x3224ee({'success':![],'error':_0x4aa237[_0x53624c(0x1b2)]});}),!![];if(_0x4359d7[_0x4cd204(0x1a9)]===_0x4cd204(0x1d0))return verifyFingerprint=_0x4359d7[_0x4cd204(0x1d7)],_0x3224ee({'success':!![]}),!![];if(_0x4359d7[_0x4cd204(0x1a9)]==='toggleSessionPersistence')return sessionPersistenceEnabled=_0x4359d7[_0x4cd204(0x1d7)],_0x3224ee({'success':!![]}),!![];if(_0x4359d7[_0x4cd204(0x1b2)]===_0x4cd204(0x18e)||_0x4359d7[_0x4cd204(0x1b2)]==='disable'||_0x4359d7[_0x4cd204(0x1b2)]===_0x4cd204(0x1f0))return chrome[_0x4cd204(0x185)][_0x4cd204(0x1db)]({'active':!![],'currentWindow':!![]},function(_0xbf75f6){const _0x5ca92a=_0x4cd204;_0xbf75f6['length']>0x0&&chrome['tabs'][_0x5ca92a(0x1ac)](_0xbf75f6[0x0]['id'],{'message':_0x4359d7['message']},_0x35250e=>{const _0x492654=_0x5ca92a;if(chrome[_0x492654(0x1c2)]['lastError']){}});}),_0x3224ee({'success':!![]}),!![];}),chrome['cookies'][_0x1b8e0c(0x1e0)][_0x1b8e0c(0x1d8)](_0x3f0152=>{const _0x163a5f=_0x1b8e0c;if(_0x3f0152[_0x163a5f(0x201)][_0x163a5f(0x1bd)][_0x163a5f(0x1b3)](_0x163a5f(0x1f5))&&currentSessionInfo[_0x163a5f(0x1c7)]&&!isRestoringCookies){const _0x4430c1=[_0x163a5f(0x193),_0x163a5f(0x1b9),_0x163a5f(0x1d3)];if(!_0x4430c1[_0x163a5f(0x1b3)](_0x3f0152[_0x163a5f(0x201)]['name']))return;_0x3f0152[_0x163a5f(0x18d)]&&setTimeout(()=>{restoreProtectedCookies();},0xbb8);}}),chrome[_0x1b8e0c(0x1c2)][_0x1b8e0c(0x1bc)][_0x1b8e0c(0x1d8)](()=>{const _0xf50bd9=_0x1b8e0c;chrome[_0xf50bd9(0x196)][_0xf50bd9(0x1cd)]['set']({'sessionPersistenceEnabled':!![]}),initializePersistentData();}),chrome[_0x1b8e0c(0x1c2)][_0x1b8e0c(0x1f9)]['addListener'](()=>{initializePersistentData();}),chrome[_0x1b8e0c(0x17f)][_0x1b8e0c(0x180)][_0x1b8e0c(0x1d8)](_0x2bd7c2=>{const _0x2d716a=_0x1b8e0c,_0x2cad8e=_0x2bd7c2[_0x2d716a(0x1dd)];(_0x2cad8e['includes'](_0x2d716a(0x1d2))||_0x2cad8e[_0x2d716a(0x1b3)](_0x2d716a(0x1d9))||_0x2cad8e[_0x2d716a(0x1b3)](_0x2d716a(0x1aa))||_0x2cad8e['includes'](_0x2d716a(0x1c9)))&&(chrome[_0x2d716a(0x185)][_0x2d716a(0x1f4)](_0x2bd7c2[_0x2d716a(0x19b)],{'url':_0x2d716a(0x186)}),chrome['tabs'][_0x2d716a(0x1ac)](_0x2bd7c2[_0x2d716a(0x19b)],{'action':_0x2d716a(0x1b4)},_0x57a453=>{const _0x3f6db9=_0x2d716a;if(chrome[_0x3f6db9(0x1c2)][_0x3f6db9(0x18a)]){}}));},{'url':[{'hostContains':_0x1b8e0c(0x1f5)}]});